<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录 - 非物质文化遗产数字交流平台</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/css/tabler.min.css">
    <link rel="stylesheet" href="css/carousel.css">
</head>
<body class="d-flex flex-column">
    <div class="page page-center">
        <div class="container-tight py-4">
            <div class="text-center mb-4">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="4" ry="4" stroke="currentColor" stroke-width="1.8" fill="url(#g)"/>
                    <path d="M8 8h8v8H8z" stroke="currentColor" stroke-width="1.5" fill="none"/>
                    <path d="M6 12h12M12 6v12" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" opacity=".75"/>
                    <defs>
                        <linearGradient id="g" x1="0" y1="0" x2="24" y2="24" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#D2691E" stop-opacity="0.25"/>
                            <stop offset="1" stop-color="#A0522D" stop-opacity="0.15"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <div class="card card-md">
                <div class="card-body">
                    <h2 class="card-title text-center mb-4">登录到平台</h2>
                    <form id="login-form" autocomplete="on">
                        <div class="mb-3">
                            <label class="form-label">账号</label>
                            <input type="text" class="form-control" id="login-username" placeholder="输入账号" required>
                        </div>
                        <div class="mb-2">
                            <label class="form-label">密码</label>
                            <div class="input-group input-group-flat">
                                <input type="password" class="form-control" id="login-password" placeholder="输入密码" required>
                            </div>
                        </div>
                        <div class="form-footer">
                            <button type="submit" class="btn btn-primary w-100">登录</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="text-center text-secondary mt-3">
                没有账号？ <a href="register.html">前往注册</a>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@tabler/core@latest/dist/js/tabler.min.js"></script>
    <script src="js/auth.js"></script>
    <script>
    // 若已登录，直接进入首页
    (function(){
        if (window.AuthDB && AuthDB.getSession()) {
            window.location.replace('index.html');
            return;
        }
        const form = document.getElementById('login-form');
        form.addEventListener('submit', function(e){
            e.preventDefault();
            const u = document.getElementById('login-username').value.trim();
            const p = document.getElementById('login-password').value;
            if (!u || !p) return;
            AuthDB.apiLogin(u, p)
            .then(() => {
                AuthDB.setSession(u);
                window.location.replace('index.html');
            })
            .catch(err => alert(err.message || '账号或密码错误'));
        });
    })();
    </script>
</body>
</html>


